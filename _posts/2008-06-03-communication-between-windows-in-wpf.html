---
layout: post
title: Communication between windows in WPF
date: '2008-06-03T15:10:00.005+02:00'
author: sax
tags:
- Window
- WPF
- Event
modified_time: '2010-01-22T11:30:18.965+01:00'
blogger_id: tag:blogger.com,1999:blog-17453343.post-2394293988641515991
blogger_orig_url: http://saxuality.blogspot.com/2008/06/communication-between-windows-in-wpf.html
---

Today I came to this problem: I have a main window with a list of data and edit button. The button opens a new window where you can edit the data. Both main window and edit window have separate DataSet objects. When I close the edit window, I need to refresh the DataSet in the main window.<br /><br />After some digging through the net I found the MSDN forum <a href="http://forums.msdn.microsoft.com/en-US/wpf/thread/df59747b-131d-41fd-a90d-0a33fb35fa03">topic</a>, but it does not work for windows.<br /><br />Then I came to the <a href="http://msdn.microsoft.com/en-us/library/ms748948.aspx">WPF Windows Overview</a> and spotted the Window Ownership section. Finally idea came to my mind - I have to set the window owner and then raise my event in it.<br /><br />Let's see parts of code:<br /><ol><br /><li>Specify window parent owner<br /><pre class="brush: csharp"><br />YourWindow w = new YourWindow();<br />w.Owner = this;<br />w.Show();<br /></pre><br /></li><br /><li>Create static class with your events<br /><pre class="brush: csharp"><br />public static class MyEvents<br />{<br />     public static readonly RoutedEvent DataUpdatedEvent<br />        = EventManager.RegisterRoutedEvent("DataUpdated",<br />            RoutingStrategy.Bubble,<br />            typeof(RoutedEventHandler), typeof(MyEvents));<br /><br />    public static void AddDataUpdatedHandler(<br />        DependencyObject element, RoutedEventHandler handler)<br />    {<br />        AddHandler(element, DataUpdatedEvent, handler);<br />    }<br /><br />    public static void RemoveDataUpdatedHandler(<br />        DependencyObject element, RoutedEventHandler handler)<br />    {<br />        RemoveHandler(element, DataUpdatedEvent, handler);<br />    }<br /><br />    private static void AddHandler(DependencyObject element,<br />        RoutedEvent routedEvent, Delegate handler)<br />    {<br />        UIElement uie = element as UIElement;<br />        if (uie != null)<br />        {<br />            uie.AddHandler(routedEvent, handler);<br />        }<br />    }<br /><br />    private static void RemoveHandler(DependencyObject element,<br />        RoutedEvent routedEvent, Delegate handler)<br />    {<br />        UIElement uie = element as UIElement;<br />        if (uie != null)<br />        {<br />            uie.RemoveHandler(routedEvent, handler);<br />        }<br />    }<br />}<br /></pre><br /></li><br /><li>Raise your event on data update<br /><pre class="brush: csharp"><br />// submit data<br />DataTableAdapter.Update(dataRow);<br />// raise data updated event<br />if (this.Owner != null)<br />{<br />    this.Owner.RaiseEvent(new RoutedEventArgs(MyEvents.DataUpdatedEvent));<br />}<br /></pre><br /></li><br /><li>Register event handler in the parent window XAML definition<br /><pre class="brush: xml"><br />&lt;Window x:Class="YourProject.ParentWindow"<br />    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"<br />    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"<br />    xmlns:src="clr-namespace:YourProject"<br />        <br />    src:MyEvents.DataUpdated="onDataUpdated"<br /><br />    Title="My parent window"&gt;<br /></pre><br /></li><br /><li>Implement event handler<br /><pre class="brush: csharp"><br />private void onDataUpdated(object sender, RoutedEventArgs e)<br />{<br />    DataTableAdapter.Fill(this.dataSet.DataTable);<br />}<br /></pre><br /></li><br /></ol><br />Do you know any better solution? Please send a comment!